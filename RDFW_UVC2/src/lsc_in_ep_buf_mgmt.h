// >>>>>>>>>>>>>>>>>>>>>>> COPYRIGHT NOTICE <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
// --------------------------------------------------------------------------
// Copyright (c) 2019-2024 by Lattice Semiconductor Corporation
// ALL RIGHTS RESERVED
// --------------------------------------------------------------------------
//
// IMPORTANT: THIS FILE IS USED BY OR GENERATED BY the LATTICE PROPELâ„¢
// DEVELOPMENT SUITE, WHICH INCLUDES PROPEL BUILDER AND PROPEL SDK.
//
// Lattice grants permission to use this code pursuant to the
// terms of the Lattice Propel License Agreement.
//
// DISCLAIMER:
//
//  LATTICE MAKES NO WARRANTIES ON THIS FILE OR ITS CONTENTS, WHETHER
//  EXPRESSED, IMPLIED, STATUTORY, OR IN ANY PROVISION OF THE LATTICE
//  PROPEL LICENSE AGREEMENT OR COMMUNICATION WITH LICENSEE, AND LATTICE
//  SPECIFICALLY DISCLAIMS ANY IMPLIED WARRANTY OF MERCHANTABILITY OR
//  FITNESS FOR A PARTICULAR PURPOSE.  LATTICE DOES NOT WARRANT THAT THE
//  FUNCTIONS CONTAINED HEREIN WILL MEET LICENSEE'S REQUIREMENTS, OR THAT
//  LICENSEE'S OPERATION OF ANY DEVICE, SOFTWARE OR SYSTEM USING THIS FILE
//  OR ITS CONTENTS WILL BE UNINTERRUPTED OR ERROR FREE, OR THAT DEFECTS
//  HEREIN WILL BE CORRECTED.  LICENSEE ASSUMES RESPONSIBILITY FOR
//  SELECTION OF MATERIALS TO ACHIEVE ITS INTENDED RESULTS, AND FOR THE
//  PROPER INSTALLATION, USE, AND RESULTS OBTAINED THEREFROM.  LICENSEE
//  ASSUMES THE ENTIRE RISK OF THE FILE AND ITS CONTENTS PROVING DEFECTIVE
//  OR FAILING TO PERFORM PROPERLY AND IN SUCH EVENT, LICENSEE SHALL
//  ASSUME THE ENTIRE COST AND RISK OF ANY REPAIR, SERVICE, CORRECTION, OR
//  ANY OTHER LIABILITIES OR DAMAGES CAUSED BY OR ASSOCIATED WITH THE
//  SOFTWARE.  IN NO EVENT SHALL LATTICE BE LIABLE TO ANY PARTY FOR DIRECT,
//  INDIRECT,SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, INCLUDING LOST
//  PROFITS, ARISING OUT OF THE USE OF THIS FILE OR ITS CONTENTS, EVEN IF
//  LATTICE HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. LATTICE'S
//  SOLE LIABILITY, AND LICENSEE'S SOLE REMEDY, IS SET FORTH ABOVE.
//  LATTICE DOES NOT WARRANT OR REPRESENT THAT THIS FILE, ITS CONTENTS OR
//  USE THEREOF DOES NOT INFRINGE ON THIRD PARTIES' INTELLECTUAL PROPERTY
//  RIGHTS, INCLUDING ANY PATENT. IT IS THE USER'S RESPONSIBILITY TO VERIFY
//  THE USER SOFTWARE DESIGN FOR CONSISTENCY AND FUNCTIONALITY THROUGH THE
//  USE OF FORMAL SOFTWARE VALIDATION METHODS.
// --------------------------------------------------------------------------

/****************************************************************************/
/**
 *
 * @file lsc_in_ep_buf_mgmt.h
 * @addtogroup lscusb Overview
 * @{
 *
 *
 *
 *****************************************************************************/

#ifndef LSC_IN_EP_BUF_MGMT_H_
#define LSC_IN_EP_BUF_MGMT_H_

#include <sys/_stdint.h>
#include "lsc_usb_dev.h"
#include "sys_platform.h"

#ifdef __cplusplus
extern "C" {
#endif


#define LSC_IEBM_BUF_MGMT_IP_BASE        IEBM_BASE_ADDR
#define LSC_IEBM_BUF_MGMT_IRQ            IEBM_IRQ
#define LSC_IEBM_BUF_MEM_BASE            0x140000
#define HW_ALLOC_BUF_DEPTH               IEBM_IEBM_HW_SINGLE_BUFR_SIZE_I

//Buffer Configuration Register
#define LSC_IEBM_BUF_CNF_REG             0x10

#define LSC_IEBM_FW_TOTAL_BUF            8
#define LSC_IEBM_FW_TOTAL_BUF_MASK       0x1E0000
#define LSC_IEBM_FW_TOTAL_BUF_OFST       17

#define LSC_IEBM_TOTAL_FW_BUF(n)            (n & LSC_IEBM_FW_TOTAL_BUF_MASK) >> LSC_IEBM_FW_TOTAL_BUF_OFST

#define LSC_IEBM_FW_SINGLE_BUF_DEPTH        16384
#define LSC_IEBM_FW_SINGLE_BUF_DEPTH_MASK   0x1FFFF

//IP Version Register
#define LSC_IEBM_IP_VER_REG             0x0

#define LSC_IEBM_IP_MAJOR_VER_MASK      0xFF000000
#define LSC_IEBM_IP_MINOR_VER_MASK      0xFF0000

//Scratch Register
#define LSC_IEBM_SCRATCH_REG            0x4

//Interrupt Enable Register
#define LSC_IEBM_INT_EN_REG             0x8

#define LSC_IEBM_BUF_AVAIL_TO_FW_INT_EN_MASK   0x1

//Interrupt Source Register
#define LSC_IEBM_INT_SRC_REG            0xC

//Hardware Parameter Information Register
#define LSC_IEBM_HW_INFO_REG            0x14

#define LSC_IEBM_HW_MAX_BUF_MASK        0xF0000000
#define LSC_IEBM_HW_MAX_BUF(n)          (n & LSC_IEBM_HW_MAX_BUF_MASK) >> 28

#define LSC_IEBM_HW_SINGLE_BUF_MAX_DEPTH_MASK   0x7FFFC00
#define LSC_IEBM_HW_SINGLE_BUF_MAX_DEPTH(n)     (n & LSC_IEBM_HW_SINGLE_BUF_MAX_DEPTH_MASK) >> 10

#define LSC_IEBM_HW_FIFO_DATA_WIDTH_MASK        0xFF

//Control Register
#define LSC_IEBM_CTRL_REG            0x18

#define LSC_IEBM_FLUSH_BUF_MASK      0x2
#define LSC_IEBM_IP_CNF_MASK         0x1

//Buffer Tracker Information Register
#define LSC_IEBM_BUF_TRACKER_INFO_REG                0x1C

#define LSC_IEBM_EXT_FIFO_MSTR_BUF_TRACKER_MASK      0xF0
#define LSC_IEBM_EXT_FIFO_MSTR_BUF_TRACKER(n)        (n & LSC_IEBM_EXT_FIFO_MSTR_BUF_TRACKER_MASK) >> 4

#define LSC_IEBM_FW_BUF_TRACKER_MASK                 0xF

//Buffer Availability Information Register
#define LSC_IEBM_BUF_AVAIL_INFO_REG                  0x20

#define LSC_IEBM_NUM_BUF_AVAIL_EXT_FIFO_MSTR_MASK    0xF0
#define LSC_IEBM_NUM_BUF_AVAIL_EXT_FIFO_MSTR(n)      (n & LSC_IEBM_NUM_BUF_AVAIL_EXT_FIFO_MSTR_MASK) >> 4

#define LSC_IEBM_NUM_BUF_TO_BE_PROCESS_BY_FW_MASK    0xF

//Buffer Exchange Control Register
#define LSC_IEBM_XCHNGCTRL_REG                  0x24

#define LSC_IEBM_BUF_HO_EXT_FIFO_MSTR_MASK      0x2
#define LSC_IEBM_BUF_HO_EXT_FIFO_MSTR(n)        (n & LSC_IEBM_BUF_HO_EXT_FIFO_MSTR_MASK) >> 1

#define LSC_IEBM_FW_PROCESSED_1_BUF_MASK        0x1

//Selectd Buffer Information Register
#define LSC_IEBM_SEL_BUF_INFO_FW_REG            0x28

#define LSC_IEBM_SEL_BUF_SZ_MASK                0x1FFFF0
#define LSC_IEBM_SEL_BUF_SZ(n)                  (n & LSC_IEBM_SEL_BUF_SZ_MASK) >> 4

#define LSC_IEBM_SEL_BUF_NUM_MASK               0xF

//Debug Register
#define LSC_IEBM_DEBUG_REG                      0x2C


//Functions
uint8_t lsc_iebm_buf_mgmt_init();
uint8_t lsc_iebm_buf_isr_register (uint32_t usb_irq, void (*isr) (void*), void *context);
void lsc_iebm_buf_int_handler (void *context);

void lsc_usb_user_application_spec (struct lsc_usb_dev *usb_dev, uint8_t usb_ep_num, uint8_t dir);

#ifdef __cplusplus
}
#endif

#endif /* IN_EP_BUF_MGMT_H_ */

/** @} */
